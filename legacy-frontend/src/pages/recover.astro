---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Recover Token">
    <h1 class="heading">Recover Token</h1>
    <form id="recoverForm">
        <label for="email">Email Address:</label>
        <input
            type="email"
            id="email"
            placeholder="email"
            name="email"
            required
        />
        <button type="submit"> Send Recovery Email</button>
    </form>
</Layout>

<script>
    import { resendToken } from "../api";

    const recoverForm = document.getElementById(
        "recoverForm",
    ) as HTMLFormElement;

    if (recoverForm) {
        recoverForm.addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(recoverForm);
            const email = formData.get("email") as string;

            await resendToken(email);

            alert(
                "If a team with that email exists, your team token has been resent.",
            );

            window.location.href = "/";
        });
    }
</script>

<style>
    form {
        display: flex;
        flex-direction: column;
    }

    input {
        margin-bottom: 1rem;
    }
</style>
